<!doctype html>
<html lang="en">
  <head>
    <title> SurreyBitcoins.com </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <style>

      .navbar {
        margin-bottom: 0;
        border-radius: 0;
        color: #FFF;
        background: #1A1A1A;
        padding: 0.5% 0;
        font-size: 1.2em;
        border: 0;
      }
      /* .navbar-brand {
        float: left;
        padding: 0 15px 15px;
        min-height: 55px;
      } */
      .navbar-inverse .navbar-nav .active a, .navbar-inverse .navbar-nav a:focus,
      .navbar-inverse .navbar-nav .active a:hover {
        color: #FFF;
        background-color: #1A1A1A;
      }
      .navbar-inverse .navbar-nav li a {
        color: #D5D5D5;
      }

    </style>

  </head>
  <body BGCOLOR="#E5E5E5">

    <nav class="navbar navbar-inverse">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <!-- remove navbar-brand if not using a picture -->
          <a class="navbar-brand" href="index.html" style="font-size:1.2em">SurreyBitcoins</a>
        </div>
        <div class="collapse navbar-collapse" id="myNavbar">
          <ul class="nav navbar-nav navbar-right">
            <li class="active"><a href="index.html">Home</a></li>
            <li><a href="#">About</a></li>
            <li><a href="#">Contact Us</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <h1 style="padding-left:10px"> SurreyBitcoins.com </h1>

    <br>

    <div id="btc" style="padding-left:35px"></div>
    <div id="bch" style="padding-left:35px"></div>
    <div id="eth" style="padding-left:35px"></div>
    <div id="ltc" style="padding-left:35px"></div>

    <br>
    <br>
    <br>

    <div id="disclaimer" style="padding: 0 10px">
      <b> User will pay for the transaction fee for both buy and sell.</b>
      <br>
      <br>
      <b>DISCLAIMER:</B> Trading in bitcoins and cryptocurrencies is subject
        to market, techincal, and legal risks. Prices vary due to local demand
        and supply. SurreyBitcoins.com does not guarantee any returns. Users use
        SurreyBitcoins.com at their own risk.
    </div>

  </body>

  <script>

    const wss = new WebSocket('wss://api.bitfinex.com/ws/')

    const conv_btc = 1.37

    // holds channel ids for each response
    var btc
    var bch
    var eth
    var ltc

    wss.onopen = () => {
      // API keys setup here (See "Authenticated Channels")
      wss.send(JSON.stringify({"event":"subscribe","channel":"ticker","pair":"BTCUSD"}))
      wss.send(JSON.stringify({"event":"subscribe","channel":"ticker","pair":"BCHUSD"}))
      wss.send(JSON.stringify({"event":"subscribe","channel":"ticker","pair":"ETHUSD"}))
      wss.send(JSON.stringify({"event":"subscribe","channel":"ticker","pair":"LTCUSD"}))
    }

    wss.onmessage = (msg) => {
      // console.log(msg.data)

       var response = JSON.parse(msg.data)

       // get channel id for each response
       if(response.pair == "BTCUSD" ) {
         btc = response.chanId
       }
       if(response.pair == "BCHUSD" ) {
         bch = response.chanId
       }
       if(response.pair == "ETHUSD" ) {
         eth = response.chanId
       }
       if(response.pair == "LTCUSD" ) {
         ltc = response.chanId
       }

       var chanid = response[0]

       if(chanid == btc) {
         var hb = response[1]
         if(hb != "hb") {
           document.getElementById('btc').innerHTML = "<b>BITCOIN----------->BUY:</b> " +
           Number(Math.round(response[3]*conv_btc*1.04+'e'+2)+'e-'+2) +
           "&nbsp&nbsp&nbsp&nbsp<b>SELL:</b> " +
           Number(Math.round(response[1]*conv_btc*0.96+'e'+2)+'e-'+2)
         }
       }

       if(chanid == bch) {
         var hb = response[1]
         if(hb != "hb") {
           document.getElementById('bch').innerHTML = "<BR><b>BITCOIN CASH-->BUY:</b> " +
           Number(Math.round(response[3]*1.40*1.05+'e'+2)+'e-'+2) +
           "&nbsp&nbsp&nbsp&nbsp<b>SELL:</b> " +
           Number(Math.round(response[1]*1.40*0.96+'e'+2)+'e-'+2)
         }
       }

       if(chanid == eth) {
         var hb = response[1]
         if(hb != "hb") {
           document.getElementById('eth').innerHTML = "<BR><b>ETHEREUM------->BUY:</b> " +
           Number(Math.round(response[3]*1.40*1.05+'e'+2)+'e-'+2) +
           "&nbsp&nbsp&nbsp&nbsp<b>SELL:</b> " +
           Number(Math.round(response[1]*1.40*0.96+'e'+2)+'e-'+2)
         }
       }

       if(chanid == ltc) {
         var hb = response[1]
         if(hb != "hb") {
           document.getElementById('ltc').innerHTML = "<BR><b>LITECOIN---------->BUY:</b> " +
           Number(Math.round(response[3]*1.40*1.05+'e'+2)+'e-'+2) +
           "&nbsp&nbsp&nbsp&nbsp<b>SELL:</b> " +
           Number(Math.round(response[1]*1.40*0.96+'e'+2)+'e-'+2)
         }
       }


    }

  </script>

</html>
